@page "/Citationissuing"
@*@attribute [Authorize(Roles = Roles.HighwayPatrolOfficer)]*@
@inherits CitationIssuingBase

@using System.ComponentModel.DataAnnotations
<MudText Typo="Typo.h3">Citation Issuing</MudText>

<div class="citation-body">
    <MudPaper Class="pa-1 ma-2" Elevation="3">

        <MudTabs Elevation="4" Rounded="true" Centered="true" Color="@Color.Primary">
            <br />
            <MudTabPanel OnClick="((e) => currentTab(1))" Text="Citizen Citation Issuing">
                <div style="max-width: 400px;">

                    <EditForm Model="@EditContext" OnValidSubmit="@OnValidSubmit">
                        <DataAnnotationsValidator />
                        <MudCard>
                            <MudCardContent>
                                <MudTextField Label="Licence ID" Variant="Variant.Outlined"
                                              @bind-Value="CitationData.licence_id" For="@(() => CitationData.licence_id)" />
                                <MudSelect Label="Select type" @bind-Value="CitationData.citizenCitationTypes" Variant="Variant.Outlined">
                                    @foreach (CitizenCitationTypes item in CitizenCitationTypes.GetValues(typeof(CitizenCitationTypes)))
                                    {
                                        <MudSelectItem Value="@item">@item.ToDescriptionString()</MudSelectItem>}
                                </MudSelect>
                            </MudCardContent>
                            <MudCardActions>
                                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">Submit</MudButton>
                            </MudCardActions>
                        </MudCard>
                    </EditForm>
                </div>
                <br />
                <MudText Typo="Typo.h6">Person Information</MudText>
                <div style="max-width: 400px;">
                    <MudTextField Value="data.GetOffenderName()" Label="Offender Name:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="data.citation_number" Label="Citation Number:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="@DangerInfo()" Label="Is Dangerous:" ReadOnly="true" Variant="Variant.Filled" Disabled="@(!IsDangerous())" />
                    <MudTextField Value="@WarrantInfo()" Label="Has Warrant:" ReadOnly="true" Variant="Variant.Filled" Disabled="@(!HasWarrant())" />
                    <MudTextField @bind-Value="data.plate_number" Label="Offender Licence Plate:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField @bind-Value="data.date_recieved" Label="Date of Offence:" ReadOnly="true" Variant="Variant.Filled" />
                </div>
                <br />
                <MudText Typo="Typo.h6">Licence Information</MudText>
                <div style="max-width: 400px;">
                    <MudTextField Value="data.is_revoked" Label="Licence Revoked:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="data.is_suspended" Label="Licence Suspended" ReadOnly="true" Variant="Variant.Filled" />
                </div>

            </MudTabPanel>

            <MudTabPanel OnClick="((e) => currentTab(2))" Text="Vehicle Citation Issuing">
                <div style="max-width: 400px;">

                    <EditForm Model="@EditContext" OnValidSubmit="@OnValidSubmit">
                        <DataAnnotationsValidator />
                        <MudCard>
                            <MudCardContent>
                                <MudTextField Label="Licence Plate" Variant="Variant.Outlined"
                                              @bind-Value="CitationData.licencePlate" For="@(() => CitationData.licencePlate)" />
                                <MudSelect Label="Select type" @bind-Value="CitationData.vehicleCitationTypes" Variant="Variant.Outlined">
                                    @foreach (VehicleCitationTypes item in VehicleCitationTypes.GetValues(typeof(VehicleCitationTypes)))
                                    {
                                        <MudSelectItem Value="@item">@item.ToDescriptionString()</MudSelectItem>}
                                </MudSelect>
                            </MudCardContent>
                            <MudCardActions>
                                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" Class="ml-auto">Submit</MudButton>
                            </MudCardActions>
                        </MudCard>
                    </EditForm>
                </div>
                <br />
                <MudText Typo="Typo.h6">Person Information</MudText>
                <div style="max-width: 400px;">
                    <MudTextField Value="data.GetOffenderName()" Label="Offender Name:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="data.citation_number" Label="Citation Number:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="@DangerInfo()" Label="Is Dangerous:" ReadOnly="true" Variant="Variant.Filled" Disabled="@(!IsDangerous())" />
                    <MudTextField Value="@WarrantInfo()" Label="Has Warrant:" ReadOnly="true" Variant="Variant.Filled" Disabled="@(!HasWarrant())" />
                    <MudTextField @bind-Value="data.plate_number" Label="Offender Licence Plate:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField @bind-Value="data.date_recieved" Label="Date of Offence:" ReadOnly="true" Variant="Variant.Filled" />
                </div>
                <br />
                <MudText Typo="Typo.h6">Vehicle Information</MudText>
                <div style="max-width: 400px;">
                    <MudTextField Value="data.vin" Label="Vehicle Number" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="data.stolen" Label="Vehicle Stolen:" ReadOnly="true" Variant="Variant.Filled" />
                    <MudTextField Value="@WarrantInfo()" Label="Vehicle Registered:" ReadOnly="true" Variant="Variant.Filled" />
                </div>

            </MudTabPanel>

        </MudTabs>
    </MudPaper>
</div>
